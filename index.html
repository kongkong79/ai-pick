<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI365PICK - Smart AI Sports Analysis</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4466358200851184"
     crossorigin="anonymous"></script>
</head>
<body>
    <header>
        <div class="container">
            <a href="index.html" class="logo-link" id="logo-link">
                 <img src="betmetrics.png?v=2" alt="AI365PICK Logo" class="logo-img">
                 <div class="logo-text-group">
                     <span class="logo-main-text">AI365PICK</span>
                     <span class="logo-sub-text">Smart AI Analysis</span>
                 </div>
            </a>
            <nav>
                <a href="index.html" class="nav-link active" data-i18n="navHome">Home</a>
                <a href="about.html" class="nav-link" data-i18n="navAbout">About</a>
                <a href="contact.html" class="nav-link" data-i18n="navContact">Contact</a>
                <a href="privacy.html" class="nav-link" data-i18n="navPrivacy">Privacy</a>
                <a href="vip.html" class="nav-link vip-link" data-i18n="navVip">VIP</a>
            </nav>
            <div class="header-controls">
                <div id="language-switcher">
                    <button class="lang-btn" data-lang="en">EN</button>
                    <button class="lang-btn" data-lang="ko">KO</button>
                    <button class="lang-btn" data-lang="ja">JA</button>
                    <button class="lang-btn" data-lang="zh">CN</button>
                </div>
                <button id="theme-toggle">â˜€ï¸</button>
            </div>
        </div>
    </header>

    <main class="container">
        <section class="hero">
            <h1 data-i18n="heroTitle">Real-time AI Sports Analysis</h1>
            <p data-i18n="heroSub">Harness the power of AI 365 days a year for smarter insights.</p>
        </section>
        
        <div id="loading-indicator" style="display: none; text-align: center; padding: 20px;" data-i18n="loading">Loading Analysis...</div>
        
        <div id="analysis-list"></div>
    </main>

    <footer>
        <div class="container">
            <div class="footer-content" style="text-align: center; padding: 40px 0;">
                <p><strong>&copy; 2024 AI365PICK. All rights reserved.</strong></p>
                <div style="font-size: 0.75rem; color: var(--text-muted); max-width: 850px; margin: 20px auto; line-height: 1.6; text-align: justify; border-top: 1px solid var(--header-border); padding-top: 20px;">
                    <p data-i18n="disclaimerEn">Disclaimer: AI365PICK provides sports data and statistical analysis based on artificial intelligence for informational purposes only. We do not facilitate gambling. (19+ Only)</p>
                    <p data-i18n="disclaimerKo">ë³¸ ì‚¬ì´íŠ¸ëŠ” ì¸ê³µì§€ëŠ¥ì„ í™œìš©í•œ ìŠ¤í¬ì¸  ë°ì´í„° ë¶„ì„ ì •ë³´ë¥¼ ì œê³µí•˜ë©°, ì–´ë– í•œ í˜•íƒœì˜ ì‚¬í–‰ì„± í–‰ìœ„ë‚˜ ì§ì ‘ì ì¸ ë² íŒ… ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // 1. ë²ˆì—­ ë°ì´í„°
        const translations = {
            en: {
                navHome: "Home", navAbout: "About", navContact: "Contact", navPrivacy: "Privacy", navVip: "VIP",
                heroTitle: "Real-time AI Sports Analysis", heroSub: "Harness the power of AI 365 days a year.",
                loading: "Loading Analysis...", unlock: "Unlock VIP Analysis", sample: "Sample", pick: "Pick"
            },
            ko: {
                navHome: "í™ˆ", navAbout: "ì†Œê°œ", navContact: "ë¬¸ì˜", navPrivacy: "ê°œì¸ì •ë³´", navVip: "VIP ì „ìš©",
                heroTitle: "ì‹¤ì‹œê°„ AI ìŠ¤í¬ì¸  ë¶„ì„", heroSub: "365ì¼ ì¸ê³µì§€ëŠ¥ì´ ì œê³µí•˜ëŠ” ìŠ¤ë§ˆíŠ¸í•œ ë¶„ì„ ë°ì´í„°.",
                loading: "ë°ì´í„° ë¡œë”© ì¤‘...", unlock: "VIP ë¶„ì„ ì—´ê¸°", sample: "í‘œë³¸ìˆ˜", pick: "ì¶”ì²œ"
            },
            ja: {
                navHome: "ãƒ›ãƒ¼ãƒ ", navAbout: "ç´¹ä»‹", navContact: "ãŠå•ã„åˆã‚ã›", navPrivacy: "ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼", navVip: "VIPå°‚ç”¨",
                heroTitle: "ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ AIã‚¹ãƒãƒ¼ãƒ„åˆ†æ", heroSub: "365æ—¥äººå·¥çŸ¥èƒ½ãŒæä¾›ã™ã‚‹ã‚¹ãƒãƒ¼ãƒˆãªåˆ†æ ë°ì´í„°ã€‚",
                loading: "èª­ã¿è¾¼ã¿ä¸­...", unlock: "VIPåˆ†æã‚’è§£é™¤", sample: "ã‚µãƒ³ãƒ—ãƒ«", pick: "ãŠã™ã™ã‚"
            },
            zh: {
                navHome: "é¦–é¡µ", navAbout: "å…³äº", navContact: "è”ç³»æˆ‘ä»¬", navPrivacy: "éšç§æ”¿ç­–", navVip: "VIPä¸“å±",
                heroTitle: "å®æ—¶AIä½“è‚²åˆ†æ", heroSub: "365å¤©äººå·¥æ™ºèƒ½ä¸ºæ‚¨æä¾›æ™ºèƒ½åˆ†ææ•°æ®ã€‚",
                loading: "åŠ è½½ä¸­...", unlock: "è§£é”VIPåˆ†æ", sample: "æ ·æœ¬æ•°", pick: "æ¨è"
            }
        };

        let currentLang = localStorage.getItem('selectedLang') || 'en';

        // 2. ì–¸ì–´ ì—…ë°ì´íŠ¸ ê¸°ëŠ¥
        function updateLanguage() {
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (translations[currentLang][key]) {
                    el.innerText = translations[currentLang][key];
                }
            });
            renderAnalysis(); 
        }

        document.querySelectorAll('.lang-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                currentLang = btn.getAttribute('data-lang');
                localStorage.setItem('selectedLang', currentLang);
                updateLanguage();
            });
        });

        // 3. í…Œë§ˆ í† ê¸€ ê¸°ëŠ¥ (ì´ ë¶€ë¶„ì´ ì¤‘ìš”í•©ë‹ˆë‹¤!)
        const themeBtn = document.getElementById('theme-toggle');
        if (themeBtn) {
            themeBtn.addEventListener('click', () => {
                const currentTheme = document.documentElement.getAttribute('data-theme');
                const targetTheme = currentTheme === 'light' ? 'dark' : 'light';
                document.documentElement.setAttribute('data-theme', targetTheme);
                localStorage.setItem('theme', targetTheme);
                themeBtn.innerText = targetTheme === 'light' ? 'â˜€ï¸' : 'ğŸŒ™';
            });
        }

        // 4. ì—‘ì…€ ë°ì´í„° ë Œë”ë§ ê¸°ëŠ¥
        async function renderAnalysis() {
            const container = document.getElementById('analysis-list');
            const loader = document.getElementById('loading-indicator');
            const isVip = localStorage.getItem('isVipUser') === 'true'; 
            const t = translations[currentLang];
            
            loader.style.display = 'block';
            container.innerHTML = ''; 
            
            try {
                const response = await fetch('sports_data.xlsx');
                const arrayBuffer = await response.arrayBuffer();
                const data = new Uint8Array(arrayBuffer);
                const workbook = XLSX.read(data, {type: 'array'});
                const sheet = workbook.Sheets[workbook.SheetNames[0]];
                const rows = XLSX.utils.sheet_to_json(sheet, {header: 1});

                const filteredRows = rows.slice(1).filter(row => parseInt(row[11]) >= 10);

                filteredRows.forEach(row => {
                    const hitRate = parseFloat(row[5]) || 0;
                    const winP = parseFloat(row[6]) || 0;
                    const drawP = parseFloat(row[7]) || 0;
                    const lossP = parseFloat(row[8]) || 0;
                    const card = document.createElement('div');
                    
                    if (hitRate >= 80 && !isVip) {
                        card.className = 'analysis-list-item vip-locked-card';
                        card.innerHTML = `
                            <span class="vip-badge-top">â­ VIP ONLY</span>
                            <div class="lock-overlay">
                                <span style="font-size: 1.5rem;">ğŸ”’</span>
                                <p style="font-weight: 800; margin:5px 0;">Hit Rate: ${hitRate}%</p>
                                <a href="vip.html" class="unlock-btn">${t.unlock}</a>
                            </div>
                            <div class="blur-target">
                                <div style="font-size:0.75rem; color:#999;">ğŸ•’ ${row[0]}</div>
                                <h3 style="font-size:1.1rem; margin:15px 0;">${row[1]} vs ${row[2]}</h3>
                                <div class="ai-chart-section"><div class="donut-chart" style="background:#e2e8f0;"></div></div>
                            </div>`;
                    } else {
                        card.className = 'analysis-list-item';
                        if (isVip && hitRate >= 80) card.style.borderColor = '#fbbf24'; 
                        card.innerHTML = `
                            <div style="display:flex; justify-content:space-between; color:var(--text-muted); font-size:0.75rem;">
                                <span>ğŸ•’ ${row[0]}</span>
                                <span>${t.sample}: ${row[11]}</span>
                            </div>
                            <h3 style="font-size:1.1rem; margin:15px 0;">${row[1]} vs ${row[2]}</h3>
                            <div style="margin-bottom:8px;"><span style="font-weight:bold; color:var(--primary-blue);">${t.pick}: ğŸ  ${row[4]}</span></div>
                            <div class="ai-chart-section">
                                <div class="donut-chart" style="background: conic-gradient(#2563eb 0% ${winP}%, #94a3b8 ${winP}% ${winP + drawP}%, #ef4444 ${winP + drawP}% 100%);"></div>
                                <div class="chart-labels">
                                    <div class="label-row"><span>Win</span> <span>${winP}%</span></div>
                                    <div class="label-row"><span>Draw</span> <span>${drawP}%</span></div>
                                    <div class="label-row"><span>Loss</span> <span>${lossP}%</span></div>
                                </div>
                            </div>
                            <div style="display:flex; justify-content:space-between; align-items:center; margin-top:auto; padding-top:10px; border-top:1px solid var(--header-border);">
                                <span style="font-size:0.85rem; font-weight:600;">Hit Rate: <b style="color:#10b981;">${hitRate}%</b></span>
                                <span style="font-size:0.7rem; color:var(--text-muted);">AI365 CORE</span>
                            </div>`;
                    }
                    container.appendChild(card);
                });
            } catch (e) { console.error(e); } finally { loader.style.display = 'none'; }
        }

        // 5. ì´ˆê¸° ì‹¤í–‰
        document.addEventListener('DOMContentLoaded', () => {
            // í…Œë§ˆ ë³µì›
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            if (themeBtn) themeBtn.innerText = savedTheme === 'light' ? 'â˜€ï¸' : 'ğŸŒ™';

            // ì–¸ì–´ ë° ë¶„ì„ ë°ì´í„° ë¡œë“œ
            updateLanguage(); 
        });
    </script>
</body>
</html>
