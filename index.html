<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n-key="appTitle">BetMetrics AI Analysis</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <header>
        <div class="container">
            <a href="index.html" class="logo-link" id="logo-link">
                 <img src="betmetrics.png?v=2" alt="BetMetrics Logo" class="logo-img">
                 <div class="logo-text-group">
                     <span class="logo-main-text">BetMetrics</span>
                     <span class="logo-sub-text">AI Analysis</span>
                 </div>
            </a>
            <nav>
                <a href="index.html" data-i18n-key="navHome" class="nav-link active">Home</a>
                <a href="about.html" data-i18n-key="navAbout" class="nav-link">About</a>
                <a href="contact.html" data-i18n-key="navContact" class="nav-link">Contact</a>
                <a href="privacy.html" data-i18n-key="navPrivacy" class="nav-link">Privacy</a>
                <a href="vip.html" class="nav-link vip-link" data-i18n-key="navVip">VIP</a>
            </nav>
            <div class="header-controls">
                <div id="language-switcher">
                    <button data-lang="en">EN</button>
                    <button data-lang="ko">KO</button>
                    <button data-lang="ja">JA</button>
                    <button data-lang="zh">CN</button>
                </div>
                <button id="theme-toggle">â˜€ï¸</button>
            </div>
        </div>
    </header>

    <main class="container">
        <section class="hero">
            <h1 data-i18n-key="headerTitle">Sports Betting Analysis</h1>
            <p data-i18n-key="headerSubtitle">Harness the power of AI for smarter sports betting.</p>
        </section>
        
        <div id="loading-indicator" style="display: none; text-align: center; padding: 20px;" data-i18n-key="loading">Loading...</div>
        
        <div id="analysis-list">
            </div>
    </main>

    <footer>
        <div class="container">
            <p data-i18n-key="footerText">&copy; 2024 BetMetrics. All rights reserved.</p>
        </div>
    </footer>

    <script src="translations.js"></script>
    <script src="main.js"></script>
    
    <script>
    // ì—‘ì…€ ë°ì´í„°ë¥¼ ì½ì–´ì„œ ì¹´ë“œë¥¼ ìƒì„±í•˜ëŠ” í•¨ìˆ˜
    async function renderAnalysis() {
        const container = document.getElementById('analysis-list');
        const loader = document.getElementById('loading-indicator');
        
        loader.style.display = 'block';
        
        try {
            const response = await fetch('sports_data.xlsx');
            const arrayBuffer = await response.arrayBuffer();
            const data = new Uint8Array(arrayBuffer);
            const workbook = XLSX.read(data, {type: 'array'});
            const sheet = workbook.Sheets[workbook.SheetNames[0]];
            const rows = XLSX.utils.sheet_to_json(sheet, {header: 1});

            container.innerHTML = '';
            
            // ë°ì´í„° í–‰ ë°˜ë³µ (ì²« ì¤„ì€ í—¤ë”ì´ë¯€ë¡œ slice(1))
            // ì‚¬ì¥ë‹˜ ìš”ì²­: í‘œë³¸(row[11])ì´ 10ê°œ ì´ìƒì¸ ê²½ê¸°ë§Œ
            const filteredRows = rows.slice(1).filter(row => parseInt(row[11]) >= 10);

            filteredRows.forEach(row => {
                const winP = parseFloat(row[6]) || 0;  // Gì—´: Win %
                const drawP = parseFloat(row[7]) || 0; // Hì—´: Draw %
                const lossP = parseFloat(row[8]) || 0; // Iì—´: Loss %
                
                const card = document.createElement('div');
                card.className = 'analysis-list-item';
                
                card.innerHTML = `
                    <div style="display:flex; justify-content:space-between; color:var(--text-muted); font-size:0.75rem;">
                        <span>ğŸ•’ ${row[0]}</span>
                        <span style="font-weight:700; color:var(--primary-blue);">Sample: ${row[11]}</span>
                    </div>
                    <h3 style="font-size:1.1rem; margin:15px 0;">${row[1]} vs ${row[2]}</h3>
                    
                    <div style="margin-bottom:8px;">
                        <span style="font-size:0.85rem; font-weight:bold; color:var(--primary-blue);">Pick: ğŸ  ${row[4]}</span>
                    </div>

                    <div class="ai-chart-section">
                        <div class="donut-chart" style="background: conic-gradient(
                            #2563eb 0% ${winP}%, 
                            #94a3b8 ${winP}% ${winP + drawP}%, 
                            #ef4444 ${winP + drawP}% 100%
                        );"></div>
                        <div class="chart-labels">
                            <div class="label-row"><span class="label-text"><i class="marker m-win"></i>Win</span> <span>${winP}%</span></div>
                            <div class="label-row"><span class="label-text"><i class="marker m-draw"></i>Draw</span> <span>${drawP}%</span></div>
                            <div class="label-row"><span class="label-text"><i class="marker m-loss"></i>Loss</span> <span>${lossP}%</span></div>
                        </div>
                    </div>

                    <div style="display:flex; justify-content:space-between; align-items:center; margin-top:auto;">
                        <span style="font-size:0.8rem;">Hit Rate: <b style="color:#10b981;">${row[5]}%</b></span>
                        <a href="vip.html" class="unlock-link" style="text-decoration:none; background:var(--text-color); color:white; padding:6px 12px; border-radius:8px; font-size:0.75rem; font-weight:bold;">VIP Analysis</a>
                    </div>
                `;
                container.appendChild(card);
            });
        } catch (error) {
            console.error('Error loading Excel:', error);
        } finally {
            loader.style.display = 'none';
        }
    }

    // ì´ˆê¸° ì‹¤í–‰
    document.addEventListener('DOMContentLoaded', () => {
        renderAnalysis();
        
        // ì‚¬ì¥ë‹˜ì´ ì‘ì„±í•˜ì‹  ê¸°ì¡´ VIP ìƒíƒœ ì²´í¬ ë¡œì§ ìœ ì§€
        const isVip = localStorage.getItem('isVipUser');
        if (isVip === 'true') {
            // (ì´ë¯¸ ë Œë”ë§ í›„ ì ìš©ë˜ë„ë¡ MutationObserver ë“±ì„ ì“¸ ìˆ˜ ìˆì§€ë§Œ 
            // ì—¬ê¸°ì„œëŠ” ë‹¨ìˆœí™”ë¥¼ ìœ„í•´ ë””ìì¸ ìˆ˜ì • ë¡œì§ë§Œ í¬í•¨)
        }
    });
    </script>
</body>
</html>
