<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n-key="appTitle">BetMetrics AI Analysis</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <header>
        <div class="container">
            <a href="index.html" class="logo-link" id="logo-link">
                 <img src="betmetrics.png?v=2" alt="BetMetrics Logo" class="logo-img">
                 <div class="logo-text-group">
                     <span class="logo-main-text">BetMetrics</span>
                     <span class="logo-sub-text">AI Analysis</span>
                 </div>
            </a>
            <nav>
                <a href="index.html" data-i18n-key="navHome" class="nav-link active">Home</a>
                <a href="about.html" data-i18n-key="navAbout" class="nav-link">About</a>
                <a href="contact.html" data-i18n-key="navContact" class="nav-link">Contact</a>
                <a href="privacy.html" data-i18n-key="navPrivacy" class="nav-link">Privacy</a>
                <a href="vip.html" class="nav-link vip-link" data-i18n-key="navVip">VIP</a>
            </nav>
            <div class="header-controls">
                <div id="language-switcher">
                    <button data-lang="en">EN</button>
                    <button data-lang="ko">KO</button>
                    <button data-lang="ja">JA</button>
                    <button data-lang="zh">CN</button>
                </div>
                <button id="theme-toggle">â˜€ï¸</button>
            </div>
        </div>
    </header>

    <main class="container">
        <section class="hero">
            <h1 data-i18n-key="headerTitle">Sports Betting Analysis</h1>
            <p data-i18n-key="headerSubtitle">Harness the power of AI for smarter sports betting.</p>
        </section>
        
        <div id="loading-indicator" style="display: none; text-align: center; padding: 20px;" data-i18n-key="loading">Loading...</div>
        
        <div id="analysis-list">
            </div>
    </main>

    <footer>
        <div class="container">
            <p data-i18n-key="footerText">&copy; 2024 BetMetrics. All rights reserved.</p>
        </div>
    </footer>

    <script src="translations.js"></script>
    
    <script>
async function renderAnalysis() {
        const container = document.getElementById('analysis-list');
        const loader = document.getElementById('loading-indicator');
        const isVip = localStorage.getItem('isVipUser') === 'true'; 
        
        loader.style.display = 'block';
        container.innerHTML = ''; 
        
        try {
            const response = await fetch('sports_data.xlsx');
            const arrayBuffer = await response.arrayBuffer();
            const data = new Uint8Array(arrayBuffer);
            const workbook = XLSX.read(data, {type: 'array'});
            const sheet = workbook.Sheets[workbook.SheetNames[0]];
            const rows = XLSX.utils.sheet_to_json(sheet, {header: 1});

            const filteredRows = rows.slice(1).filter(row => parseInt(row[11]) >= 10);

            filteredRows.forEach(row => {
                const hitRate = parseFloat(row[5]) || 0;
                const winP = parseFloat(row[6]) || 0;
                const drawP = parseFloat(row[7]) || 0;
                const lossP = parseFloat(row[8]) || 0;
                
                const card = document.createElement('div');
                
                if (hitRate >= 80 && !isVip) {
                    // [VIP ì ê¸´ ì¹´ë“œ] - ì—¬ê¸°ëŠ” ìœ ì¸ì„ ìœ„í•´ ë²„íŠ¼ì´ í•„ìš”í•©ë‹ˆë‹¤.
                    card.className = 'analysis-list-item vip-locked-card';
                    card.innerHTML = `
                        <span class="vip-badge-top">â­ VIP ONLY</span>
                        <div class="lock-overlay">
                            <span style="font-size: 1.5rem; margin-bottom: 8px;">ğŸ”’</span>
                            <p style="font-size: 0.85rem; font-weight: 800; color: #b45309; margin:0;">Accuracy: ${hitRate}%</p>
                            <a href="vip.html" style="margin-top:12px; background:#fbbf24; color:#000; padding:8px 18px; border-radius:20px; text-decoration:none; font-size:0.75rem; font-weight:bold; box-shadow: 0 4px 10px rgba(251,191,36,0.3);">Unlock VIP Analysis</a>
                        </div>
                        <div class="blur-target">
                            <div style="display:flex; justify-content:space-between; font-size:0.75rem; color:#999;">
                                <span>ğŸ•’ ${row[0]}</span>
                            </div>
                            <h3 style="font-size:1.1rem; margin:15px 0;">${row[1]} vs ${row[2]}</h3>
                            <div class="ai-chart-section">
                                <div class="donut-chart" style="background: #e2e8f0;"></div>
                            </div>
                        </div>
                    `;
                } else {
                    // [ì¼ë°˜ ê³µê°œ ì¹´ë“œ] - ë²„íŠ¼ì„ ì—†ì• ê³  ì •ë³´ë¥¼ ë” í¬ê²Œ ë³´ì—¬ì¤ë‹ˆë‹¤.
                    card.className = 'analysis-list-item';
                    if (isVip && hitRate >= 80) card.style.borderColor = '#fbbf24'; 

                    card.innerHTML = `
                        <div style="display:flex; justify-content:space-between; color:var(--text-muted); font-size:0.75rem;">
                            <span>ğŸ•’ ${row[0]}</span>
                            <span style="font-weight:700; color:var(--primary-blue);">Sample: ${row[11]}</span>
                        </div>
                        <h3 style="font-size:1.1rem; margin:15px 0;">${row[1]} vs ${row[2]}</h3>
                        <div style="margin-bottom:8px;">
                            <span style="font-size:0.9rem; font-weight:bold; color:var(--primary-blue);">Pick: ğŸ  ${row[4]}</span>
                        </div>
                        
                        <div class="ai-chart-section">
                            <div class="donut-chart" style="background: conic-gradient(
                                #2563eb 0% ${winP}%, 
                                #94a3b8 ${winP}% ${winP + drawP}%, 
                                #ef4444 ${winP + drawP}% 100%
                            );"></div>
                            <div class="chart-labels">
                                <div class="label-row"><span class="label-text"><i class="marker m-win"></i>Win</span> <span>${winP}%</span></div>
                                <div class="label-row"><span class="label-text"><i class="marker m-draw"></i>Draw</span> <span>${drawP}%</span></div>
                                <div class="label-row"><span class="label-text"><i class="marker m-loss"></i>Loss</span> <span>${lossP}%</span></div>
                            </div>
                        </div>

                        <div style="display:flex; justify-content:space-between; align-items:center; margin-top:auto; padding-top:10px; border-top:1px solid var(--header-border);">
                            <span style="font-size:0.85rem; font-weight:600;">Hit Rate: <b style="color:#10b981;">${hitRate}%</b></span>
                            <span style="font-size:0.75rem; color:var(--text-muted); font-style:italic;">AI Verified</span>
                        </div>
                    `;
                }
                container.appendChild(card);
            });
        } catch (error) {
            console.error('Excel Loading Error:', error);
        } finally {
            loader.style.display = 'none';
        }
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ë‹¨ í•œ ë²ˆë§Œ ì‹¤í–‰
    document.addEventListener('DOMContentLoaded', renderAnalysis);
    </script>
</body>
</html>
