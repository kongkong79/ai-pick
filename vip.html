<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIP Access - BetMetrics</title>
    <link rel="stylesheet" href="style.css?v=110">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        #vip-unlocked-section { display: flex; flex-direction: column; align-items: center; text-align: center; width: 100%; }
        .summary-card { margin: 30px auto !important; width: 95%; max-width: 900px; display: inline-block; background: var(--card-bg); border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); overflow: hidden; }
        .summary-header { background: #007bff; color: white; padding: 15px; font-weight: bold; display: flex; justify-content: space-between; }
        .summary-table { width: 100%; border-collapse: collapse; }
        .summary-table th, .summary-table td { padding: 15px 10px; text-align: center !important; border-bottom: 1px solid #eee; }
        
        /* VIP ì „ìš© ë°°ì§€ ìŠ¤íƒ€ì¼ */
        .badge-banker { background: #d1fae5; color: #065f46; padding: 4px 8px; border-radius: 4px; font-weight: bold; border: 1px solid #10b981; margin-left: 5px; font-size: 0.8rem; }
        .badge-warning { background: #fee2e2; color: #991b1b; padding: 4px 8px; border-radius: 4px; font-weight: bold; border: 1px solid #ef4444; margin-left: 5px; font-size: 0.8rem; }
        
        [data-theme="dark"] .summary-table td { color: #f1f5f9; border-bottom: 1px solid #334155; }
        [data-theme="dark"] .summary-table tr { background: #1e293b; }
        .condition-tag { background: #f8f9fa; padding: 15px; border-top: 1px solid #eee; text-align: left; font-size: 0.85rem; color: #666; }
        [data-theme="dark"] .condition-tag { background: #0f172a; border-color: #334155; color: #94a3b8; }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <a href="index.html" class="logo-link">
                 <img src="betmetrics.png?v=3" alt="BetMetrics Logo" class="logo-img">
                 <div class="logo-text-group">
                     <span class="logo-main-text">BetMetrics</span>
                     <span class="logo-sub-text">AI Analysis</span>
                 </div>
            </a>
            <nav>
                <a href="index.html" class="nav-link">Home</a>
                <a href="vip.html" class="nav-link active">VIP</a>
            </nav>
        </div>
    </header>

    <main class="container">
        <section id="vip-locked-section" class="hero" style="display: none;">
            <h1 style="color: #fbbf24;">â­ VIP Premium Member</h1>
            <div class="analysis-list-item" style="max-width: 500px; margin: 40px auto; border: 2px solid #fbbf24; text-align: center; padding: 30px; border-radius: 15px;">
                <div class="lock-icon" style="font-size: 50px;">ğŸ”’</div>
                <h3>VIP Exclusive Benefits</h3>
                <p>Get access to 80%+ Win Rate AI reports.</p>
                <a href="https://kongkong79.gumroad.com/l/ai-sports-vip" target="_blank" class="nav-link" style="display: block; background: #fbbf24; color: #000; padding: 15px; border-radius: 12px; font-weight: 800; text-decoration: none; margin: 20px 0;">Subscribe Now ($9.99)</a>
                <input type="text" id="vip-code-input" placeholder="Enter Code" style="padding: 10px; width: 60%; border-radius: 4px; border: 1px solid #ccc;">
                <button onclick="verifyVipCode()" style="padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;">Verify</button>
            </div>
        </section>

        <section id="vip-unlocked-section" style="display: none;">
            <h1 style="color: #007bff;">âœ… VIP Member Zone</h1>
            <div class="summary-card">
                <div class="summary-header">
                    <span>ğŸ”¥ AI Smart Picks (High Accuracy)</span>
                    <span id="target-date">Loading Date...</span>
                </div>
                <table class="summary-table">
                    <thead>
                        <tr>
                            <th>Match</th>
                            <th>AI Recommendation</th>
                            <th>Accuracy</th>
                            <th>Odds</th>
                        </tr>
                    </thead>
                    <tbody id="vip-data-body">
                        </tbody>
                </table>
                <div class="condition-tag">
                    <strong>Filtering Logic:</strong><br>
                    â€¢ â­ <strong>Banker:</strong> Home Odds â‰¤ 1.10 (Historical Accuracy 88%+)<br>
                    â€¢ âš ï¸ <strong>Draw Risk:</strong> Predicted Away Win with Home Odds 1.7-1.9 (High Draw probability)
                </div>
            </div>
            
            <button onclick="logoutVip()" style="margin-top: 20px; color: gray; background: none; border: none; text-decoration: underline; cursor: pointer;">Logout</button>
        </section>
    </main>

   <script>
    const VIP_CODE = "FEB888";

   async function initVipPage() {
        const tbody = document.getElementById('vip-data-body');
        const dateDisplay = document.getElementById('target-date');
        
        try {
            dateDisplay.innerText = "ë°ì´í„° ì‹ ë¢°ë„ ê²€ì¦ ì¤‘ (í‘œë³¸ 10ê°œ ì´ìƒ)...";
            
            const response = await fetch('sports_data.xlsx?v=' + Math.random());
            if (!response.ok) throw new Error('íŒŒì¼ ë¡œë“œ ì‹¤íŒ¨');
            
            const arrayBuffer = await response.arrayBuffer();
            const data = new Uint8Array(arrayBuffer);
            const workbook = XLSX.read(data, { type: 'array' });
            const sheet = workbook.Sheets[workbook.SheetNames[0]];
            
            // ëª¨ë“  ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ë˜ ë¹ˆ ì¹¸ì„ 0ìœ¼ë¡œ ì±„ì›€
            const rows = XLSX.utils.sheet_to_json(sheet, { header: 1, defval: 0 });

            if (rows.length < 2) throw new Error('ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');

            tbody.innerHTML = '';
            
            // ë°ì´í„° í•„í„°ë§ ì‹œì‘
            const dataRows = rows.slice(1); 
            let filteredCount = 0;

            dataRows.forEach(row => {
                // ì‚¬ì¥ë‹˜ ì—‘ì…€ ê¸°ì¤€: Lì—´(ì¸ë±ìŠ¤ 11)ì´ Sample Countì…ë‹ˆë‹¤.
                const sampleCount = parseInt(row[11]); 
                const homeTeam = row[1];
                const awayTeam = row[2];
                const homeOdds = parseFloat(row[3]);
                const aiPick = String(row[4]);
                const hitRate = row[5];
                const time = row[0];

                // [í•µì‹¬ í•„í„°] í‘œë³¸ì´ 10ê°œ ë¯¸ë§Œì¸ ë°ì´í„°ëŠ” VIPì—ê²Œ ë³´ì—¬ì£¼ì§€ ì•ŠìŒ
                if (sampleCount < 10) return;

                let pickHtml = aiPick.includes("Home") 
                    ? '<span class="badge-home">ğŸ  Home Win</span>' 
                    : '<span class="badge-away">âœˆï¸ Away Win</span>';

                // [Banker ë¡œì§] ë°°ë‹¹ 1.15 ì´í•˜ + í‘œë³¸ 10ê°œ ì´ìƒì´ë©´ ìµœê°• ì•ˆì „ë¹µ
                if (homeOdds > 0 && homeOdds <= 1.15) {
                    pickHtml += '<span class="badge-banker">â­ Banker</span>';
                }

                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td style="text-align:left !important; padding-left:20px;">
                        <span style="font-size:0.7rem; color:gray; display:block;">${time}</span>
                        <span style="font-weight:bold;">${homeTeam}</span> 
                        <span style="font-size:0.8rem; color:#888;">vs ${awayTeam}</span>
                    </td>
                    <td>${pickHtml}</td>
                    <td style="color:#059669; font-weight:bold;">${hitRate}%</td>
                    <td>
                        <span style="font-weight:bold;">${homeOdds.toFixed(2)}</span><br>
                        <small style="color:#999; font-size:0.7rem;">Samples: ${sampleCount}</small>
                    </td>
                `;
                tbody.appendChild(tr);
                filteredCount++;
            });

            dateDisplay.innerText = `Verified Picks: ${filteredCount} Matches`;

            if (filteredCount === 0) {
                tbody.innerHTML = `<tr><td colspan="4" style="padding:50px;">í‘œë³¸ 10ê°œ ì´ìƒì˜ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ê°€ ì•„ì§ ì—†ìŠµë‹ˆë‹¤.</td></tr>`;
            }

        } catch (err) {
            console.error(err);
            dateDisplay.innerText = "Filter Error";
        }
    }
    // --- ì•„ë˜ ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ í•¨ìˆ˜ëŠ” ê¸°ì¡´ê³¼ ë™ì¼í•˜ê²Œ ìœ ì§€ ---
    function checkStatus() {
        const isVip = localStorage.getItem('isVipUser') === 'true';
        document.getElementById('vip-locked-section').style.display = isVip ? 'none' : 'block';
        document.getElementById('vip-unlocked-section').style.display = isVip ? 'block' : 'none';
        if (isVip) initVipPage();
    }
    function verifyVipCode() {
        const val = document.getElementById('vip-code-input').value;
        if (val === VIP_CODE) { localStorage.setItem('isVipUser', 'true'); location.reload(); }
        else { alert("Wrong code."); }
    }
    function logoutVip() { localStorage.removeItem('isVipUser'); location.reload(); }
    document.addEventListener('DOMContentLoaded', () => {
        const savedTheme = localStorage.getItem('theme') || 'light';
        document.documentElement.setAttribute('data-theme', savedTheme);
        checkStatus();
    });
</script>

</body>
</html>
