<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIP Access - BetMetrics</title>
    <link rel="stylesheet" href="style.css?v=110">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        #vip-unlocked-section { display: flex; flex-direction: column; align-items: center; text-align: center; width: 100%; }
        .summary-card { margin: 30px auto !important; width: 95%; max-width: 900px; display: inline-block; background: var(--card-bg); border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); overflow: hidden; }
        .summary-header { background: #007bff; color: white; padding: 15px; font-weight: bold; display: flex; justify-content: space-between; }
        .summary-table { width: 100%; border-collapse: collapse; }
        .summary-table th, .summary-table td { padding: 15px 10px; text-align: center !important; border-bottom: 1px solid #eee; }
        
        /* VIP ì „ìš© ë°°ì§€ ìŠ¤íƒ€ì¼ */
        .badge-banker { background: #d1fae5; color: #065f46; padding: 4px 8px; border-radius: 4px; font-weight: bold; border: 1px solid #10b981; margin-left: 5px; font-size: 0.8rem; }
        .badge-warning { background: #fee2e2; color: #991b1b; padding: 4px 8px; border-radius: 4px; font-weight: bold; border: 1px solid #ef4444; margin-left: 5px; font-size: 0.8rem; }
        
        [data-theme="dark"] .summary-table td { color: #f1f5f9; border-bottom: 1px solid #334155; }
        [data-theme="dark"] .summary-table tr { background: #1e293b; }
        .condition-tag { background: #f8f9fa; padding: 15px; border-top: 1px solid #eee; text-align: left; font-size: 0.85rem; color: #666; }
        [data-theme="dark"] .condition-tag { background: #0f172a; border-color: #334155; color: #94a3b8; }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <a href="index.html" class="logo-link">
                 <img src="betmetrics.png?v=3" alt="BetMetrics Logo" class="logo-img">
                 <div class="logo-text-group">
                     <span class="logo-main-text">BetMetrics</span>
                     <span class="logo-sub-text">AI Analysis</span>
                 </div>
            </a>
            <nav>
                <a href="index.html" class="nav-link">Home</a>
                <a href="vip.html" class="nav-link active">VIP</a>
            </nav>
        </div>
    </header>

    <main class="container">
        <section id="vip-locked-section" class="hero" style="display: none;">
            <h1 style="color: #fbbf24;">â­ VIP Premium Member</h1>
            <div class="analysis-list-item" style="max-width: 500px; margin: 40px auto; border: 2px solid #fbbf24; text-align: center; padding: 30px; border-radius: 15px;">
                <div class="lock-icon" style="font-size: 50px;">ğŸ”’</div>
                <h3>VIP Exclusive Benefits</h3>
                <p>Get access to 80%+ Win Rate AI reports.</p>
                <a href="https://kongkong79.gumroad.com/l/ai-sports-vip" target="_blank" class="nav-link" style="display: block; background: #fbbf24; color: #000; padding: 15px; border-radius: 12px; font-weight: 800; text-decoration: none; margin: 20px 0;">Subscribe Now ($9.99)</a>
                <input type="text" id="vip-code-input" placeholder="Enter Code" style="padding: 10px; width: 60%; border-radius: 4px; border: 1px solid #ccc;">
                <button onclick="verifyVipCode()" style="padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;">Verify</button>
            </div>
        </section>

        <section id="vip-unlocked-section" style="display: none;">
            <h1 style="color: #007bff;">âœ… VIP Member Zone</h1>
            <div class="summary-card">
                <div class="summary-header">
                    <span>ğŸ”¥ AI Smart Picks (High Accuracy)</span>
                    <span id="target-date">Loading Date...</span>
                </div>
                <table class="summary-table">
                    <thead>
                        <tr>
                            <th>Match</th>
                            <th>AI Recommendation</th>
                            <th>Accuracy</th>
                            <th>Odds</th>
                        </tr>
                    </thead>
                    <tbody id="vip-data-body">
                        </tbody>
                </table>
                <div class="condition-tag">
                    <strong>Filtering Logic:</strong><br>
                    â€¢ â­ <strong>Banker:</strong> Home Odds â‰¤ 1.10 (Historical Accuracy 88%+)<br>
                    â€¢ âš ï¸ <strong>Draw Risk:</strong> Predicted Away Win with Home Odds 1.7-1.9 (High Draw probability)
                </div>
            </div>
            
            <button onclick="logoutVip()" style="margin-top: 20px; color: gray; background: none; border: none; text-decoration: underline; cursor: pointer;">Logout</button>
        </section>
    </main>

   <script>
    const VIP_CODE = "FEB888";

    async function initVipPage() {
        const tbody = document.getElementById('vip-data-body');
        const dateDisplay = document.getElementById('target-date');
        
        try {
            dateDisplay.innerText = "ìµœì‹  AI ë¶„ì„ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...";
            
            // ì—‘ì…€ íŒŒì¼ ì½ê¸° (ìºì‹œ ë°©ì§€)
            const response = await fetch('sports_data.xlsx?v=' + Math.random());
            if (!response.ok) throw new Error('sports_data.xlsx íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            
            const arrayBuffer = await response.arrayBuffer();
            const data = new Uint8Array(arrayBuffer);
            const workbook = XLSX.read(data, { type: 'array' });
            const sheet = workbook.Sheets[workbook.SheetNames[0]];
            
            // í—¤ë”ë¥¼ í¬í•¨í•˜ì—¬ ë°°ì—´ë¡œ ë³€í™˜
            const rows = XLSX.utils.sheet_to_json(sheet, { header: 1, defval: "" });

            if (rows.length < 2) throw new Error('ì—‘ì…€ì— í‘œì‹œí•  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');

            tbody.innerHTML = '';
            
            // ì²« ë²ˆì§¸ ì¤„(í—¤ë”) ì œì™¸í•˜ê³  ìƒìœ„ 20ê°œ ê²½ê¸° í‘œì‹œ
            const dataRows = rows.slice(1); 
            dateDisplay.innerText = "Today's Live Analysis";

            dataRows.forEach(row => {
                // ì‚¬ì¥ë‹˜ ì—‘ì…€ ì»¬ëŸ¼ ê¸°ì¤€ (0ë¶€í„° ì‹œì‘)
                const time = row[0];        // Aì—´: ì‹œê°„
                const homeTeam = row[1];    // Bì—´: í™ˆíŒ€
                const awayTeam = row[2];    // Cì—´: ì›ì •íŒ€
                const homeOdds = parseFloat(row[3]); // Dì—´: í™ˆë°°ë‹¹
                const aiPick = row[4];      // Eì—´: AI Recommendation
                const hitRate = row[5];     // Fì—´: Hit rate

                if (!homeTeam) return; // ë°ì´í„°ê°€ ë¹„ì–´ìˆìœ¼ë©´ ê±´ë„ˆëœ€

                let pickHtml = "";
                // AI ì¶”ì²œ ë¬¸êµ¬ì— ë”°ë¥¸ ë°°ì§€ ì„¤ì •
                if (aiPick.includes("Home")) {
                    pickHtml = '<span class="badge-home">ğŸ  Home Win</span>';
                } else {
                    pickHtml = '<span class="badge-away">âœˆï¸ Away Win</span>';
                }

                // [VIP íŠ¹ë³„ ë¡œì§]
                // 1. ë°°ë‹¹ì´ 1.15 ì´í•˜ë¡œ ë‚®ìœ¼ë©´ ë¬´ì¡°ê±´ Banker
                if (homeOdds > 0 && homeOdds <= 1.15) {
                    pickHtml += '<span class="badge-banker">â­ Banker</span>';
                }
                // 2. ì ì¤‘ë¥ ì´ 100%ì´ê±°ë‚˜ ë§¤ìš° ë†’ìœ¼ë©´ ë³„ë„ í‘œì‹œ (ì„ íƒì‚¬í•­)
                if (parseFloat(hitRate) >= 90) {
                    pickHtml += '<span class="badge-banker" style="background:#dbeafe; color:#1e40af; border-color:#3b82f6;">ğŸ”¥ Hot</span>';
                }

                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td style="text-align:left !important; padding-left:20px;">
                        <span style="font-size:0.7rem; color:gray; display:block;">${time}</span>
                        <span style="font-weight:bold;">${homeTeam}</span> 
                        <span style="font-size:0.8rem; color:#888;">vs ${awayTeam}</span>
                    </td>
                    <td>${pickHtml}</td>
                    <td style="color:#059669; font-weight:bold;">${hitRate}%</td>
                    <td style="font-weight:bold;">${homeOdds > 0 ? homeOdds.toFixed(2) : '-'}</td>
                `;
                tbody.appendChild(tr);
            });

        } catch (err) {
            console.error(err);
            dateDisplay.innerText = "Error!";
            tbody.innerHTML = `<tr><td colspan="4" style="padding:50px; color:red;">
                <b>ë°ì´í„° ë¡œë”© ì‹¤íŒ¨:</b> ${err.message}<br>
                <small>íŒŒì¼ëª…ì´ <b>sports_data.xlsx</b>ì¸ì§€, ê¹ƒí—ˆë¸Œì— ì˜ ì˜¬ë¼ê°”ëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.</small>
            </td></tr>`;
        }
    }

    // --- ì•„ë˜ ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ í•¨ìˆ˜ëŠ” ê¸°ì¡´ê³¼ ë™ì¼í•˜ê²Œ ìœ ì§€ ---
    function checkStatus() {
        const isVip = localStorage.getItem('isVipUser') === 'true';
        document.getElementById('vip-locked-section').style.display = isVip ? 'none' : 'block';
        document.getElementById('vip-unlocked-section').style.display = isVip ? 'block' : 'none';
        if (isVip) initVipPage();
    }
    function verifyVipCode() {
        const val = document.getElementById('vip-code-input').value;
        if (val === VIP_CODE) { localStorage.setItem('isVipUser', 'true'); location.reload(); }
        else { alert("Wrong code."); }
    }
    function logoutVip() { localStorage.removeItem('isVipUser'); location.reload(); }
    document.addEventListener('DOMContentLoaded', () => {
        const savedTheme = localStorage.getItem('theme') || 'light';
        document.documentElement.setAttribute('data-theme', savedTheme);
        checkStatus();
    });
</script>

</body>
</html>
