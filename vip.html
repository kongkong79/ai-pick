// 1. 페이지 로드 시 VIP 상태 체크하여 화면 전환
function checkVipStatus() {
    const isVip = localStorage.getItem('isVipUser') === 'true';
    const lockedSec = document.getElementById('vip-locked-section');
    const unlockedSec = document.getElementById('vip-unlocked-section');
    const logoutBtn = document.getElementById('logout-btn'); // 로그아웃 버튼 가져오기

    if (isVip) {
        if (lockedSec) lockedSec.style.display = 'none';
        if (unlockedSec) unlockedSec.style.display = 'block';
        if (logoutBtn) logoutBtn.style.display = 'inline-block'; // VIP면 버튼 보이게 함
    } else {
        if (lockedSec) lockedSec.style.display = 'block';
        if (unlockedSec) unlockedSec.style.display = 'none';
        if (logoutBtn) logoutBtn.style.display = 'none'; // 아니면 버튼 숨김
    }
}

// 2. VIP 코드(VIP777) 인증 함수
async function verifyVipCode() {
    const inputCode = document.getElementById('vip-code-input').value.trim();
    const verifyBtn = document.getElementById('verify-btn');

    if (!inputCode) {
        alert("Please enter your Access Code.");
        return;
    }

    verifyBtn.disabled = true;
    verifyBtn.innerText = "Verifying...";

    if (inputCode === "VIP777") {
        alert("Success! VIP Access Granted.");
        localStorage.setItem('isVipUser', 'true');
        localStorage.setItem('userLicense', inputCode);
        
        // 새로고침하여 위 checkVipStatus()가 실행되게 함
        window.location.reload(); 
    } else {
        alert("Invalid code. Please check your email.");
        verifyBtn.disabled = false;
        verifyBtn.innerText = "Verify";
    }
}

// 3. 로그아웃 함수
function logoutVip() {
    if (confirm("Logout from VIP session?")) {
        localStorage.removeItem('isVipUser');
        localStorage.removeItem('userLicense');
        window.location.reload(); // 새로고침하여 초기 잠금 상태로 이동
    }
}

// 페이지 로드 즉시 실행
document.addEventListener('DOMContentLoaded', checkVipStatus);
