<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIP Access - BetMetrics</title>
    <link rel="stylesheet" href="style.css?v=110">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        #vip-unlocked-section { display: flex; flex-direction: column; align-items: center; text-align: center; width: 100%; }
        .summary-card { margin: 30px auto !important; width: 95%; max-width: 900px; display: inline-block; background: var(--card-bg); border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); overflow: hidden; }
        .summary-header { background: #007bff; color: white; padding: 15px; font-weight: bold; display: flex; justify-content: space-between; }
        .summary-table { width: 100%; border-collapse: collapse; }
        .summary-table th, .summary-table td { padding: 15px 10px; text-align: center !important; border-bottom: 1px solid #eee; }
        
        /* VIP ì „ìš© ë°°ì§€ ìŠ¤íƒ€ì¼ */
        .badge-banker { background: #d1fae5; color: #065f46; padding: 4px 8px; border-radius: 4px; font-weight: bold; border: 1px solid #10b981; margin-left: 5px; font-size: 0.8rem; }
        .badge-warning { background: #fee2e2; color: #991b1b; padding: 4px 8px; border-radius: 4px; font-weight: bold; border: 1px solid #ef4444; margin-left: 5px; font-size: 0.8rem; }
        
        [data-theme="dark"] .summary-table td { color: #f1f5f9; border-bottom: 1px solid #334155; }
        [data-theme="dark"] .summary-table tr { background: #1e293b; }
        .condition-tag { background: #f8f9fa; padding: 15px; border-top: 1px solid #eee; text-align: left; font-size: 0.85rem; color: #666; }
        [data-theme="dark"] .condition-tag { background: #0f172a; border-color: #334155; color: #94a3b8; }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <a href="index.html" class="logo-link">
                 <img src="betmetrics.png?v=3" alt="BetMetrics Logo" class="logo-img">
                 <div class="logo-text-group">
                     <span class="logo-main-text">BetMetrics</span>
                     <span class="logo-sub-text">AI Analysis</span>
                 </div>
            </a>
            <nav>
                <a href="index.html" class="nav-link">Home</a>
                <a href="vip.html" class="nav-link active">VIP</a>
            </nav>
        </div>
    </header>

    <main class="container">
        <section id="vip-locked-section" class="hero" style="display: none;">
            <h1 style="color: #fbbf24;">â­ VIP Premium Member</h1>
            <div class="analysis-list-item" style="max-width: 500px; margin: 40px auto; border: 2px solid #fbbf24; text-align: center; padding: 30px; border-radius: 15px;">
                <div class="lock-icon" style="font-size: 50px;">ğŸ”’</div>
                <h3>VIP Exclusive Benefits</h3>
                <p>Get access to 80%+ Win Rate AI reports.</p>
                <a href="https://kongkong79.gumroad.com/l/ai-sports-vip" target="_blank" class="nav-link" style="display: block; background: #fbbf24; color: #000; padding: 15px; border-radius: 12px; font-weight: 800; text-decoration: none; margin: 20px 0;">Subscribe Now ($9.99)</a>
                <input type="text" id="vip-code-input" placeholder="Enter Code" style="padding: 10px; width: 60%; border-radius: 4px; border: 1px solid #ccc;">
                <button onclick="verifyVipCode()" style="padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;">Verify</button>
            </div>
        </section>

        <section id="vip-unlocked-section" style="display: none;">
            <h1 style="color: #007bff;">âœ… VIP Member Zone</h1>
            <div class="summary-card">
                <div class="summary-header">
                    <span>ğŸ”¥ AI Smart Picks (High Accuracy)</span>
                    <span id="target-date">Loading Date...</span>
                </div>
                <table class="summary-table">
                    <thead>
                        <tr>
                            <th>Match</th>
                            <th>AI Recommendation</th>
                            <th>Accuracy</th>
                            <th>Odds</th>
                        </tr>
                    </thead>
                    <tbody id="vip-data-body">
                        </tbody>
                </table>
                <div class="condition-tag">
                    <strong>Filtering Logic:</strong><br>
                    â€¢ â­ <strong>Banker:</strong> Home Odds â‰¤ 1.10 (Historical Accuracy 88%+)<br>
                    â€¢ âš ï¸ <strong>Draw Risk:</strong> Predicted Away Win with Home Odds 1.7-1.9 (High Draw probability)
                </div>
            </div>
            
            <button onclick="logoutVip()" style="margin-top: 20px; color: gray; background: none; border: none; text-decoration: underline; cursor: pointer;">Logout</button>
        </section>
    </main>

    <script>
       const VIP_CODE = "FEB888";

async function initVipPage() {
    const tbody = document.getElementById('vip-data-body');
    const dateDisplay = document.getElementById('target-date');
    
    try {
        dateDisplay.innerText = "ë°ì´í„° ì½ëŠ” ì¤‘...";
        
        // 1. ì—‘ì…€ íŒŒì¼ ê°€ì ¸ì˜¤ê¸° (íŒŒì¼ ì´ë¦„ ë‹¤ì‹œ í•œë²ˆ í™•ì¸!)
        const response = await fetch('sports_data.xlsx?v=' + new Date().getTime()); // ìºì‹œ ë°©ì§€ ì¶”ê°€
        if (!response.ok) throw new Error('íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. (íŒŒì¼ëª… í™•ì¸ í•„ìš”)');
        
        const arrayBuffer = await response.arrayBuffer();
        const data = new Uint8Array(arrayBuffer);
        const workbook = XLSX.read(data, { type: 'array' });
        
        // 2. ì²« ë²ˆì§¸ ì‹œíŠ¸ ê°€ì ¸ì˜¤ê¸°
        const sheetName = workbook.SheetNames[0];
        const firstSheet = workbook.Sheets[sheetName];
        
        // 3. ë°ì´í„°ë¥¼ ë°°ì—´ í˜•íƒœë¡œ ë³€í™˜ (í—¤ë” í¬í•¨)
        const jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });
        
        if (jsonData.length < 2) {
            dateDisplay.innerText = "ì—‘ì…€ì— ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.";
            return;
        }

        tbody.innerHTML = '';
        const rows = jsonData.slice(1).filter(r => r.length > 5);
        
        // 4. ìµœì‹  ë‚ ì§œ ì°¾ê¸°
        const maxDate = Math.max(...rows.map(r => parseInt(r[1])).filter(d => !isNaN(d)));
        dateDisplay.innerText = `Update: ${maxDate}`;

        // 5. ë°ì´í„° ë¿Œë¦¬ê¸°
        rows.forEach(row => {
            const matchDate = parseInt(row[1]);
            if (matchDate === maxDate) {
                const homeTeam = row[2];
                const predScore = String(row[4]);
                const homeOdds = parseFloat(row[6]);

                const scores = predScore.split(':');
                const isAwayWinPred = parseInt(scores[1]) > parseInt(scores[0]);

                let pickHtml = isAwayWinPred ? '<span class="badge-away">âœˆï¸ Away Win</span>' : '<span class="badge-home">ğŸ  Home Win</span>';
                let accuracy = "70.2% ~";

                if (homeOdds <= 1.1) {
                    pickHtml += '<span class="badge-banker">â­ Banker</span>';
                    accuracy = "88.1%";
                } else if (isAwayWinPred && homeOdds >= 1.7 && homeOdds <= 1.9) {
                    pickHtml += '<span class="badge-warning">âš ï¸ Draw Risk</span>';
                    accuracy = "Caution";
                }

                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td style="font-weight:bold;">${homeTeam}</td>
                    <td>${pickHtml}</td>
                    <td style="color:#059669; font-weight:bold;">${accuracy}</td>
                    <td>${homeOdds ? homeOdds.toFixed(2) : '-'}</td>
                `;
                tbody.appendChild(tr);
            }
        });

    } catch (err) {
        console.error("ì—ëŸ¬ ë°œìƒ:", err);
        dateDisplay.innerText = "ì˜¤ë¥˜: " + err.message;
        tbody.innerHTML = `<tr><td colspan="4" style="padding:50px;">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.<br>íŒŒì¼ëª…ì´ <b>sports_data.xlsx</b>ê°€ ë§ëŠ”ì§€ í™•ì¸í•´ ì£¼ì„¸ìš”.</td></tr>`;
    }
}
    </script>
</body>
</html>
