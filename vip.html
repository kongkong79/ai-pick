<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIP Access - BetMetrics</title>
    <link rel="stylesheet" href="style.css?v=110">
    <style>
        /* 1. ì „ì²´ ì»¨í…Œì´ë„ˆ ë° í—¤ë” ì¤‘ì•™ ì •ë ¬ */
        #vip-unlocked-section {
            display: flex;
            flex-direction: column;
            align-items: center; 
            text-align: center;
            width: 100%;
        }

        /* 2. í…Œì´ë¸” ì¹´ë“œ ë°•ìŠ¤ ì¤‘ì•™ ì •ë ¬ */
        .summary-card {
            margin: 30px auto !important;
            width: 95%;
            max-width: 900px;
            display: inline-block;
        }

        /* 3. í…Œì´ë¸” ë‚´ë¶€ ë°ì´í„° ì •ì¤‘ì•™ ì •ë ¬ */
        .summary-table {
            width: 100%;
            border-collapse: collapse;
            margin: 0 auto;
        }

        .summary-table th, 
        .summary-table td {
            padding: 15px 10px;
            text-align: center !important; 
            vertical-align: middle;
        }

        /* 4. VIP ì „ìš© íŠ¹ìˆ˜ ë°°ì§€ ìŠ¤íƒ€ì¼ */
        .badge-banker {
            background: #d1fae5; color: #065f46;
            padding: 4px 8px; border-radius: 4px; font-weight: bold; border: 1px solid #10b981; margin-left: 5px;
        }
        .badge-warning {
            background: #fee2e2; color: #991b1b;
            padding: 4px 8px; border-radius: 4px; font-weight: bold; border: 1px solid #ef4444; margin-left: 5px;
        }
        [data-theme="dark"] .badge-banker { background: #064e3b; color: #34d399; }
        [data-theme="dark"] .badge-warning { background: #7f1d1d; color: #fca5a5; }

        /* 5. í•˜ë‹¨ ì—‘ì…€ ë°•ìŠ¤ ë° ë‹¤í¬ëª¨ë“œ í•´ê²° */
        #vip-unlocked-section .analysis-list-item {
            width: 90%; max-width: 600px; margin: 40px auto !important;
            padding: 30px; border-radius: 12px; display: flex; flex-direction: column; align-items: center;
        }

        [data-theme="dark"] .summary-table tr { background-color: #1e293b !important; }
        [data-theme="dark"] .summary-table td { color: #f1f5f9 !important; border-bottom: 1px solid #334155 !important; }
        [data-theme="dark"] .analysis-list-item { background-color: #1e293b !important; color: #f1f5f9 !important; border: 1px solid #334155 !important; }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <a href="index.html" class="logo-link">
                 <img src="betmetrics.png?v=3" alt="BetMetrics Logo" class="logo-img">
                 <div class="logo-text-group">
                     <span class="logo-main-text">BetMetrics</span>
                     <span class="logo-sub-text">AI Analysis</span>
                 </div>
            </a>
            <nav>
                <a href="index.html" class="nav-link">Home</a>
                <a href="vip.html" class="nav-link active">VIP</a>
            </nav>
        </div>
    </header>

    <main class="container">
        <section id="vip-locked-section" class="hero">
            <h1 style="color: #fbbf24;">â­ VIP Premium Member</h1>
            <div class="analysis-list-item" style="max-width: 500px; margin: 40px auto; border: 2px solid #fbbf24; text-align: center;">
                <div class="lock-icon" style="font-size: 50px;">ğŸ”’</div>
                <h3>VIP Exclusive Benefits</h3>
                <p style="font-size: 0.9rem; color: #666; margin-bottom: 20px;">Get access to 80%+ Win Rate AI reports.</p>
                <a href="https://kongkong79.gumroad.com/l/ai-sports-vip" target="_blank" class="nav-link" style="display: block; background: #fbbf24; color: #000; padding: 15px; border-radius: 12px; font-weight: 800; text-decoration: none; margin: 20px 0;">
                    Subscribe to VIP on Gumroad ($9.99)
                </a>
                <div style="margin-top: 20px; padding-top: 20px; border-top: 1px dashed #ccc;">
                    <p style="font-size: 0.85rem; margin-bottom: 10px;">Already a member? Enter this month's code:</p>
                    <div style="display: flex; gap: 5px; justify-content: center;">
                        <input type="text" id="vip-code-input" placeholder="Enter Access Code" style="padding: 10px; width: 60%; border: 1px solid #ccc; border-radius: 4px;">
                        <button id="verify-btn" onclick="verifyVipCode()" style="padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;">Verify</button>
                    </div>
                </div>
            </div>
        </section>

        <section id="vip-unlocked-section" style="display: none; text-align: center;">
            <h1 style="color: #007bff;">âœ… VIP Member Zone</h1>

            <div class="summary-card">
                <div class="summary-header">
                    <span>ğŸ”¥ Today's AI Smart Picks</span>
                    <span id="current-date-display" style="font-size: 0.8rem; opacity: 0.9;">Loading...</span>
                </div>
                <div style="overflow-x: auto;">
                    <table class="summary-table" id="vip-table">
                        <thead>
                            <tr>
                                <th>Match</th>
                                <th>AI Recommendation</th>
                                <th>Exp. Win Rate</th>
                                <th>Home Odds</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            </tbody>
                    </table>
                </div>
                <div class="condition-tag" style="text-align: left; padding: 15px; font-size: 0.8rem; line-height: 1.5;">
                    <strong>ğŸ“Š VIP Filtering Logic:</strong><br>
                    â€¢ <strong>Banker:</strong> Home Odds â‰¤ 1.1 (Hit Rate 80%+ based on historical data)<br>
                    â€¢ <strong>Draw Alert:</strong> Away Win predicted with Home Odds 1.7~1.9 (High Draw risk)<br>
                    â€¢ <strong>Data Driven:</strong> Matches filtered from latest sports_data.csv
                </div>
            </div>

            <div class="analysis-list-item">
                <h3>Full Analysis Spreadsheet</h3>
                <a href="sports_data.xlsx" download class="nav-link" style="display: inline-block; background: #28a745; color: white; padding: 12px 25px; border-radius: 8px; font-weight: bold; text-decoration: none;">
                    ğŸ“¥ Download sports_data.xlsx
                </a>
            </div>

            <button onclick="logoutVip()" style="background: none; border: none; color: gray; cursor: pointer; text-decoration: underline; font-size: 0.8rem; margin-bottom: 40px;">
                Logout / End Session
            </button>
        </section>
    </main>

    <script>
        const CURRENT_MONTH_CODE = "FEB888"; 

        // 1. ì—‘ì…€(CSV) ë°ì´í„° ìë™ ë¡œë“œ ë° VIP í•„í„°ë§
        async function loadVipData() {
            try {
                const response = await fetch('sports_data.csv'); // íŒŒì¼ëª…ì´ ë‹¤ë¥´ë©´ ìˆ˜ì •í•˜ì„¸ìš”
                const csvText = await response.text();
                const rows = csvText.split('\n').filter(row => row.trim() !== '');
                const headers = rows[0].split(',');

                // ì‹¤ì œë‚ ì§œ(Index 1), í™ˆíŒ€(Index 2), ì˜ˆì¸¡ìŠ¤ì½”ì–´(Index 4), í™ˆìŠ¹ë°°ë‹¹(Index 6)
                const dataRows = rows.slice(1);
                
                // ê°€ì¥ ìµœì‹  ë‚ ì§œ ì°¾ê¸°
                const dates = dataRows.map(r => parseInt(r.split(',')[1])).filter(d => !isNaN(d));
                const maxDate = Math.max(...dates);
                document.getElementById('current-date-display').innerText = `Date: ${maxDate}`;

                const tbody = document.querySelector('#vip-table tbody');
                tbody.innerHTML = '';

                dataRows.forEach(row => {
                    const cols = row.split(',');
                    const matchDate = parseInt(cols[1]);
                    
                    if (matchDate === maxDate) {
                        const homeTeam = cols[2];
                        const predScore = cols[4];
                        const homeOdds = parseFloat(cols[6]);
                        
                        // ìŠ¹/ë¬´/íŒ¨ ì˜ˆì¸¡ ë¡œì§
                        const scoreArr = predScore.split(':');
                        const isAwayWinPred = parseInt(scoreArr[1]) > parseInt(scoreArr[0]);
                        
                        let pickHtml = isAwayWinPred ? '<span class="badge-away">âœˆï¸ Away Win</span>' : '<span class="badge-home">ğŸ  Home Win</span>';
                        let winRate = "70.2% ~";

                        // [VIP ë¡œì§ 1] Banker (í™ˆë°°ë‹¹ 1.1 ì´í•˜)
                        if (homeOdds <= 1.1) {
                            pickHtml += '<span class="badge-banker">â­ Banker</span>';
                            winRate = "88.1%";
                        } 
                        // [VIP ë¡œì§ 2] Draw Risk (ì›ì •ìŠ¹ ì˜ˆì¸¡ + í™ˆë°°ë‹¹ 1.7~1.9)
                        else if (isAwayWinPred && homeOdds >= 1.7 && homeOdds <= 1.9) {
                            pickHtml += '<span class="badge-warning">âš ï¸ Draw Risk</span>';
                            winRate = "21~30% (Low)";
                        }

                        const tr = document.createElement('tr');
                        tr.innerHTML = `
                            <td style="font-weight:bold;">${homeTeam}</td>
                            <td>${pickHtml}</td>
                            <td>${winRate}</td>
                            <td>${homeOdds.toFixed(2)}</td>
                            <td><span style="color:#10b981;">â— Live</span></td>
                        `;
                        tbody.appendChild(tr);
                    }
                });
            } catch (err) {
                console.error("Data load error:", err);
            }
        }

        // ë¡œê·¸ì¸ í™•ì¸ ë° ë°ì´í„° ë¡œë“œ ì‹¤í–‰
        function checkVipStatus() {
            const isVip = localStorage.getItem('isVipUser') === 'true';
            const expireTime = localStorage.getItem('vipExpireDate');
            const now = new Date().getTime();

            const lockedSec = document.getElementById('vip-locked-section');
            const unlockedSec = document.getElementById('vip-unlocked-section');

            if (isVip && (!expireTime || now < expireTime)) {
                lockedSec.style.display = 'none';
                unlockedSec.style.display = 'block';
                loadVipData(); // ë¡œê·¸ì¸ ì„±ê³µ ì‹œì—ë§Œ ë°ì´í„° ë¡œë“œ
            } else {
                lockedSec.style.display = 'block';
                unlockedSec.style.display = 'none';
            }
        }

        function verifyVipCode() {
            const inputCode = document.getElementById('vip-code-input').value.trim();
            if (inputCode === CURRENT_MONTH_CODE) {
                const lastDay = new Date(new Date().getFullYear(), new Date().getMonth() + 1, 0, 23, 59, 59).getTime();
                localStorage.setItem('isVipUser', 'true');
                localStorage.setItem('vipExpireDate', lastDay);
                location.reload();
            } else {
                alert("Invalid code.");
            }
        }

        function logoutVip() {
            localStorage.removeItem('isVipUser');
            location.reload();
        }

        document.addEventListener('DOMContentLoaded', () => {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            checkVipStatus();
        });
    </script>
</body>
</html>
